
import { News } from '../models/News';

// Initial news data
const initialNews: News[] = [
  {
    id: 1,
    title: "Запуск завода в Забайкалье",
    date: "Август 2024",
    summary: "ООО «Гранит» ввело в эксплуатацию завод по производству компонентов эмульсионных взрывчатых веществ (ЭВВ) мощностью 30 тыс. тонн/год.",
    fullText: "ООО «Гранит» завершило строительство завода в Забайкалье, который специализируется на производстве компонентов эмульсионных взрывчатых веществ (ЭВВ). Производственные мощности завода составляют 30 тыс. тонн продукции в год, что позволяет компании обеспечивать собственные проекты и расширять географию поставок. Особое внимание уделяется экологичности производства: внедрены технологии переработки мешкотары, минимизирующие воздействие на окружающую среду. Этот шаг подтверждает приверженность компании к устойчивому развитию. Новый завод станет важным звеном в развитии региональной экономики.",
    imageUrl: "https://images.unsplash.com/photo-1518770660439-4636190af475",
    metaTitle: "Запуск завода в Забайкалье | ООО «Гранит»",
    metaDescription: "ООО «Гранит» ввело в эксплуатацию завод по производству компонентов эмульсионных взрывчатых веществ (ЭВВ) мощностью 30 тыс. тонн/год."
  },
  {
    id: 2,
    title: "Успешные испытания патронов в Хабаровске",
    date: "Июнь 2024",
    summary: "Начало выпуска эмульсионных патронов диаметром 32–90 мм для автономного применения.",
    fullText: "ООО «Гранит» успешно провело испытания новой линии по производству эмульсионных патронов в Хабаровске. Патроны диаметром 32–90 мм предназначены для автономного применения в сложных климатических условиях. Тестирование показало высокую эффективность продукции, что делает её идеальным решением для удалённых объектов. Новая линия станет ключевым элементом в развитии производственных мощностей компании. Компания планирует увеличить объёмы выпуска патронов в ближайшие годы.",
    imageUrl: "https://images.unsplash.com/photo-1605810230434-7631ac76ec81",
    metaTitle: "Успешные испытания патронов в Хабаровске | ООО «Гранит»",
    metaDescription: "Начало выпуска эмульсионных патронов диаметром 32–90 мм для автономного применения в сложных климатических условиях."
  },
  {
    id: 3,
    title: "Участие в проекте БАМ-2",
    date: "Май 2024",
    summary: "Применение мобильных ПСЗУ позволило сократить сроки взрывных работ на 15%.",
    fullText: "ООО «Гранит» активно участвует в строительстве БАМ-2, применяя мобильные смесительно-зарядные установки (ПСЗУ). Использование современного оборудования позволило сократить сроки выполнения взрывных работ на 15%. Это подтверждает высокий уровень технической оснащённости компании и её способность решать задачи любой сложности. Участие в проекте укрепляет позиции ООО «Гранит» как надёжного партнёра. Компания гордится вкладом в развитие инфраструктуры страны.",
    imageUrl: "https://images.unsplash.com/photo-1526374965328-7f61d4dc18c5",
    metaTitle: "Участие в проекте БАМ-2 | ООО «Гранит»",
    metaDescription: "Применение мобильных ПСЗУ позволило сократить сроки выполнения взрывных работ на проекте БАМ-2 на 15%."
  },
  {
    id: 4,
    title: "Внедрение российского оборудования",
    date: "Апрель 2024",
    summary: "Компания полностью перешла на использование российского оборудования: контроллеры «Овен», уровнемеры «Титан», расходомеры «Эмисс».",
    fullText: "ООО «Гранит» завершило переход на использование российского оборудования, включая контроллеры «Овен», уровнемеры «Титан» и расходомеры «Эмисс». Это решение направлено на минимизацию зависимости от импортных поставщиков и повышение технологической независимости. Внедрение отечественных решений также способствует развитию российского машиностроения. Компания продолжает инвестировать в модернизацию производственных процессов. Переход на российское оборудование повысил надёжность работы оборудования на объектах.",
    imageUrl: "https://images.unsplash.com/photo-1531297484001-80022131f5a1",
    metaTitle: "Внедрение российского оборудования | ООО «Гранит»",
    metaDescription: "ООО «Гранит» завершило переход на использование российского оборудования: контроллеры «Овен», уровнемеры «Титан», расходомеры «Эмисс»."
  },
  {
    id: 5,
    title: "Обучение молодых специалистов",
    date: "Февраль 2024",
    summary: "ООО «Гранит» запустило программу обучения молодых специалистов в рамках сотрудничества с профильными вузами.",
    fullText: "ООО «Гранит» запустило программу обучения молодых специалистов в рамках сотрудничества с профильными вузами. Студенты проходят практику на производственных участках, участвуют в реальных проектах и получают навыки работы с современным оборудованием. Программа направлена на подготовку квалифицированных кадров для будущих проектов компании. Это инвестиция в развитие отрасли и укрепление позиций ООО «Гранит». Участники программы уже демонстрируют высокие результаты в работе.",
    imageUrl: "https://images.unsplash.com/photo-1581091226825-a6a2a5aee158",
    metaTitle: "Обучение молодых специалистов | ООО «Гранит»",
    metaDescription: "ООО «Гранит» запустило программу обучения молодых специалистов в рамках сотрудничества с профильными вузами."
  }
];

// Create localStorage key
const NEWS_STORAGE_KEY = 'granite_news';

// Get all news from local storage or use initial data
export const getAllNews = (): News[] => {
  const storageData = localStorage.getItem(NEWS_STORAGE_KEY);
  if (storageData) {
    return JSON.parse(storageData);
  }
  
  // Initialize with default data
  localStorage.setItem(NEWS_STORAGE_KEY, JSON.stringify(initialNews));
  return initialNews;
};

// Get a single news item by ID
export const getNewsById = (id: number): News | undefined => {
  const news = getAllNews();
  return news.find(item => item.id === id);
};

// Add a new news item
export const addNews = (news: Omit<News, 'id'>): News => {
  const currentNews = getAllNews();
  const maxId = currentNews.reduce((max, item) => Math.max(max, item.id), 0);
  
  const newNews: News = {
    ...news,
    id: maxId + 1
  };
  
  const updatedNews = [newNews, ...currentNews];
  localStorage.setItem(NEWS_STORAGE_KEY, JSON.stringify(updatedNews));
  
  return newNews;
};

// Update an existing news item
export const updateNews = (updatedNews: News): News => {
  const currentNews = getAllNews();
  const updatedList = currentNews.map(item => 
    item.id === updatedNews.id ? updatedNews : item
  );
  
  localStorage.setItem(NEWS_STORAGE_KEY, JSON.stringify(updatedList));
  return updatedNews;
};

// Delete a news item
export const deleteNews = (id: number): boolean => {
  const currentNews = getAllNews();
  const filteredNews = currentNews.filter(item => item.id !== id);
  
  if (filteredNews.length === currentNews.length) {
    return false; // Nothing was deleted
  }
  
  localStorage.setItem(NEWS_STORAGE_KEY, JSON.stringify(filteredNews));
  return true;
};
